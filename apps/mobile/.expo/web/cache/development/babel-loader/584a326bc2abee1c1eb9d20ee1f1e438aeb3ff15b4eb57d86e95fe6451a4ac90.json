{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { CameraView, useCameraPermissions } from 'expo-camera';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar QRScannerModal = function QRScannerModal(_ref) {\n  var visible = _ref.visible,\n    onClose = _ref.onClose,\n    onScan = _ref.onScan;\n  var _useCameraPermissions = useCameraPermissions(),\n    _useCameraPermissions2 = _slicedToArray(_useCameraPermissions, 2),\n    permission = _useCameraPermissions2[0],\n    requestPermission = _useCameraPermissions2[1];\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    scanned = _useState2[0],\n    setScanned = _useState2[1];\n  if (!permission) {\n    return _jsx(View, {});\n  }\n  if (!permission.granted) {\n    return _jsx(Modal, {\n      visible: visible,\n      animationType: \"slide\",\n      children: _jsxs(View, {\n        style: styles.container,\n        children: [_jsx(Text, {\n          style: styles.message,\n          children: \"We need your permission to show the camera\"\n        }), _jsx(Button, {\n          onPress: requestPermission,\n          title: \"grant permission\"\n        }), _jsx(Button, {\n          title: \"Close\",\n          onPress: onClose\n        })]\n      })\n    });\n  }\n  var handleBarcodeScanned = function handleBarcodeScanned(scanningResult) {\n    if (scanned) return;\n    setScanned(true);\n    onScan(scanningResult.data);\n    onClose();\n    setTimeout(function () {\n      return setScanned(false);\n    }, 1000);\n  };\n  return _jsx(Modal, {\n    visible: visible,\n    animationType: \"slide\",\n    onRequestClose: onClose,\n    children: _jsxs(View, {\n      style: styles.container,\n      children: [_jsx(CameraView, {\n        style: StyleSheet.absoluteFillObject,\n        facing: \"back\",\n        onBarcodeScanned: scanned ? undefined : handleBarcodeScanned,\n        barcodeScannerSettings: {\n          barcodeTypes: [\"qr\"]\n        }\n      }), _jsx(View, {\n        style: styles.overlay,\n        children: _jsx(Button, {\n          title: \"Cancel\",\n          onPress: onClose,\n          color: \"#FF0000\"\n        })\n      })]\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    backgroundColor: '#000'\n  },\n  message: {\n    textAlign: 'center',\n    paddingBottom: 10,\n    color: 'white'\n  },\n  overlay: {\n    position: 'absolute',\n    bottom: 50,\n    left: 0,\n    right: 0,\n    alignItems: 'center'\n  }\n});\nexport default QRScannerModal;","map":{"version":3,"names":["React","useState","View","Text","Modal","StyleSheet","Button","CameraView","useCameraPermissions","jsx","_jsx","jsxs","_jsxs","QRScannerModal","_ref","visible","onClose","onScan","_useCameraPermissions","_useCameraPermissions2","_slicedToArray","permission","requestPermission","_useState","_useState2","scanned","setScanned","granted","animationType","children","style","styles","container","message","onPress","title","handleBarcodeScanned","scanningResult","data","setTimeout","onRequestClose","absoluteFillObject","facing","onBarcodeScanned","undefined","barcodeScannerSettings","barcodeTypes","overlay","color","create","flex","justifyContent","backgroundColor","textAlign","paddingBottom","position","bottom","left","right","alignItems"],"sources":["/Users/asearer/Documents/Projects/safety-suggestion-reporting-system/apps/mobile/src/components/QRScannerModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { View, Text, Modal, StyleSheet, Button } from 'react-native';\nimport { CameraView, useCameraPermissions, BarcodeScanningResult } from 'expo-camera';\n\ninterface QRScannerModalProps {\n    visible: boolean;\n    onClose: () => void;\n    onScan: (data: string) => void;\n}\n\nconst QRScannerModal: React.FC<QRScannerModalProps> = ({ visible, onClose, onScan }) => {\n    const [permission, requestPermission] = useCameraPermissions();\n    const [scanned, setScanned] = useState(false);\n\n    if (!permission) {\n        // Camera permissions are still loading\n        return <View />;\n    }\n\n    if (!permission.granted) {\n        return (\n            <Modal visible={visible} animationType=\"slide\">\n                <View style={styles.container}>\n                    <Text style={styles.message}>We need your permission to show the camera</Text>\n                    <Button onPress={requestPermission} title=\"grant permission\" />\n                    <Button title=\"Close\" onPress={onClose} />\n                </View>\n            </Modal>\n        );\n    }\n\n    const handleBarcodeScanned = (scanningResult: BarcodeScanningResult) => {\n        if (scanned) return;\n        setScanned(true);\n        onScan(scanningResult.data);\n        onClose();\n        // Reset scanned state after a short delay so the user can scan again if they re-open the modal immediately\n        setTimeout(() => setScanned(false), 1000);\n    };\n\n    return (\n        <Modal visible={visible} animationType=\"slide\" onRequestClose={onClose}>\n            <View style={styles.container}>\n                <CameraView\n                    style={StyleSheet.absoluteFillObject}\n                    facing=\"back\"\n                    onBarcodeScanned={scanned ? undefined : handleBarcodeScanned}\n                    barcodeScannerSettings={{\n                        barcodeTypes: [\"qr\"],\n                    }}\n                />\n                <View style={styles.overlay}>\n                    <Button title=\"Cancel\" onPress={onClose} color=\"#FF0000\" />\n                </View>\n            </View>\n        </Modal>\n    );\n};\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        justifyContent: 'center',\n        backgroundColor: '#000',\n    },\n    message: {\n        textAlign: 'center',\n        paddingBottom: 10,\n        color: 'white',\n    },\n    overlay: {\n        position: 'absolute',\n        bottom: 50,\n        left: 0,\n        right: 0,\n        alignItems: 'center',\n    },\n});\n\nexport default QRScannerModal;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AAAC,OAAAC,IAAA;AAAA,OAAAC,IAAA;AAAA,OAAAC,KAAA;AAAA,OAAAC,UAAA;AAAA,OAAAC,MAAA;AAExC,SAASC,UAAU,EAAEC,oBAAoB,QAA+B,aAAa;AAAC,SAAAC,GAAA,IAAAC,IAAA,EAAAC,IAAA,IAAAC,KAAA;AAQtF,IAAMC,cAA6C,GAAG,SAAhDA,cAA6CA,CAAAC,IAAA,EAAqC;EAAA,IAA/BC,OAAO,GAAAD,IAAA,CAAPC,OAAO;IAAEC,OAAO,GAAAF,IAAA,CAAPE,OAAO;IAAEC,MAAM,GAAAH,IAAA,CAANG,MAAM;EAC7E,IAAAC,qBAAA,GAAwCV,oBAAoB,CAAC,CAAC;IAAAW,sBAAA,GAAAC,cAAA,CAAAF,qBAAA;IAAvDG,UAAU,GAAAF,sBAAA;IAAEG,iBAAiB,GAAAH,sBAAA;EACpC,IAAAI,SAAA,GAA8BtB,QAAQ,CAAC,KAAK,CAAC;IAAAuB,UAAA,GAAAJ,cAAA,CAAAG,SAAA;IAAtCE,OAAO,GAAAD,UAAA;IAAEE,UAAU,GAAAF,UAAA;EAE1B,IAAI,CAACH,UAAU,EAAE;IAEb,OAAOX,IAAA,CAACR,IAAI,IAAE,CAAC;EACnB;EAEA,IAAI,CAACmB,UAAU,CAACM,OAAO,EAAE;IACrB,OACIjB,IAAA,CAACN,KAAK;MAACW,OAAO,EAAEA,OAAQ;MAACa,aAAa,EAAC,OAAO;MAAAC,QAAA,EAC1CjB,KAAA,CAACV,IAAI;QAAC4B,KAAK,EAAEC,MAAM,CAACC,SAAU;QAAAH,QAAA,GAC1BnB,IAAA,CAACP,IAAI;UAAC2B,KAAK,EAAEC,MAAM,CAACE,OAAQ;UAAAJ,QAAA,EAAC;QAA0C,CAAM,CAAC,EAC9EnB,IAAA,CAACJ,MAAM;UAAC4B,OAAO,EAAEZ,iBAAkB;UAACa,KAAK,EAAC;QAAkB,CAAE,CAAC,EAC/DzB,IAAA,CAACJ,MAAM;UAAC6B,KAAK,EAAC,OAAO;UAACD,OAAO,EAAElB;QAAQ,CAAE,CAAC;MAAA,CACxC;IAAC,CACJ,CAAC;EAEhB;EAEA,IAAMoB,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAAIC,cAAqC,EAAK;IACpE,IAAIZ,OAAO,EAAE;IACbC,UAAU,CAAC,IAAI,CAAC;IAChBT,MAAM,CAACoB,cAAc,CAACC,IAAI,CAAC;IAC3BtB,OAAO,CAAC,CAAC;IAETuB,UAAU,CAAC;MAAA,OAAMb,UAAU,CAAC,KAAK,CAAC;IAAA,GAAE,IAAI,CAAC;EAC7C,CAAC;EAED,OACIhB,IAAA,CAACN,KAAK;IAACW,OAAO,EAAEA,OAAQ;IAACa,aAAa,EAAC,OAAO;IAACY,cAAc,EAAExB,OAAQ;IAAAa,QAAA,EACnEjB,KAAA,CAACV,IAAI;MAAC4B,KAAK,EAAEC,MAAM,CAACC,SAAU;MAAAH,QAAA,GAC1BnB,IAAA,CAACH,UAAU;QACPuB,KAAK,EAAEzB,UAAU,CAACoC,kBAAmB;QACrCC,MAAM,EAAC,MAAM;QACbC,gBAAgB,EAAElB,OAAO,GAAGmB,SAAS,GAAGR,oBAAqB;QAC7DS,sBAAsB,EAAE;UACpBC,YAAY,EAAE,CAAC,IAAI;QACvB;MAAE,CACL,CAAC,EACFpC,IAAA,CAACR,IAAI;QAAC4B,KAAK,EAAEC,MAAM,CAACgB,OAAQ;QAAAlB,QAAA,EACxBnB,IAAA,CAACJ,MAAM;UAAC6B,KAAK,EAAC,QAAQ;UAACD,OAAO,EAAElB,OAAQ;UAACgC,KAAK,EAAC;QAAS,CAAE;MAAC,CACzD,CAAC;IAAA,CACL;EAAC,CACJ,CAAC;AAEhB,CAAC;AAED,IAAMjB,MAAM,GAAG1B,UAAU,CAAC4C,MAAM,CAAC;EAC7BjB,SAAS,EAAE;IACPkB,IAAI,EAAE,CAAC;IACPC,cAAc,EAAE,QAAQ;IACxBC,eAAe,EAAE;EACrB,CAAC;EACDnB,OAAO,EAAE;IACLoB,SAAS,EAAE,QAAQ;IACnBC,aAAa,EAAE,EAAE;IACjBN,KAAK,EAAE;EACX,CAAC;EACDD,OAAO,EAAE;IACLQ,QAAQ,EAAE,UAAU;IACpBC,MAAM,EAAE,EAAE;IACVC,IAAI,EAAE,CAAC;IACPC,KAAK,EAAE,CAAC;IACRC,UAAU,EAAE;EAChB;AACJ,CAAC,CAAC;AAEF,eAAe9C,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}